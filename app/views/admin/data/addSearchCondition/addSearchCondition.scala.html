@()(implicit request: play.api.mvc.RequestHeader)
@admin.main("配置字段类型") {
    <script src="@routes.Assets.at("layer-3.1.1/dist/layer.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("dist2/bootstrap-advanced-sortable/js/bootstrap-advanced-sortable.js")" type="text/javascript"></script>
    <link rel="stylesheet" media="screen" href="@routes.Assets.at("dist2/bootstrap-advanced-sortable/css/bootstrap-advanced-sortable.css")">
    <style>
            .form-control {
                display: block;
                width: 100%;
                height: 34px;
                padding: 6px 12px;
                font-size: 14px;
                line-height: 1.42857143;
                color: #555;
                background: #fff none;
                border: 1px solid #ccc;
                border-radius: 4px;
                -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
                box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
                -webkit-transition: border-color ease-in-out .15s, -webkit-box-shadow ease-in-out .15s;
                -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
                transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
            }
    </style>


    @admin.data.Alias.body()

    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="gridSystemModalLabel" id="staticBackdrop">
        <div class="modal-dialog modal-xl  modal-dialog-centered modal-dialog-scrollable" style="position: relative;
            right: 90px">
            <div class="modal-content" style="width: 800px">
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                    <h4 class="modal-title">
                        <i class="fa fa-plus"></i>
                        <span id="lblAddTitle" style="font-weight: bold">新增</span>
                    </h4>
                </div>
                <form class="form-horizontal" id="form" action="" data-toggle="validator" enctype="multipart/form-data">
                    <div class="modal-body">
                        <div class="row-fluid" style="margin: 20px">

                            <form role="form">
                                <div class="form-group">
                                    <label>请输入您的字段类型配置，示例如下</label>
                                    <textarea id="textarea1" class="form-control" rows="3" style="height: 300px;
                                        margin-bottom: 10px"></textarea>
                                    <span class="example" >eg.,
                                        <a href="javascript:filldata();">
                                            <em id="egCrics">示例文件</em>
                                        </a>
                                    </span>
                                </div>
                            </form>

                        </div>
                    </div>
                    <div class="modal-footer bg-info">
                        <input type="hidden" id="ID" name="ID" />
                        <button type="button" class="btn blue" onclick="submit1()">确定</button>
                        <button type="button" class="btn green" data-dismiss="modal">取消</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
            //展示示例输入
            function filldata() {

                let str = `Sample_ID=num
Patient_Name=name`
                $('#textarea1').val(str)
            }


            function submit1() {
                var datavalue = $('#textarea1').val()
                $('#staticBackdrop').modal('hide')
                console.log(datavalue)
                $.ajax({
                    /* TODO*/
                    url: "@adminC.routes.DataController.addMutationAlias()",
                    type: "post",
                    data: datavalue,
                    contentType: "text/plain;charset=utf8",
                    success: function (res) {
                        alert(res)
                    },
                    error: function (res) {
                        swal({
                            title: "",
                            text: "提交失败，请检查您的格式是否正确",
                            icon: "error",
                            button: "Aww yiss!",
                        });
                    }
                })
            }

            function deleteKitList() {
                swal({
                            title: "",
                            text: "确定删除？\n",
                            type: "warning",
                            showCancelButton: true,
                            showConfirmButton: true,
                            confirmButtonClass: "btn-danger",
                            confirmButtonText: "确定",
                            closeOnConfirm: false,//设置为false才可以触发双重swal
                            cancelButtonClass: "btn-outline-danger",
                            cancelButtonText: "取消"
                        },
                        function () {
                            var index = layer.load(1, {
                                shade: [0.1, '#fff']
                            });
                            var rows = $("#table").bootstrapTable('getSelections')
                            let ids = '';
                            for (var i = 0; i < rows.length; i++) {
                                ids += rows[i]['id'] + ","
                            }
                            ids = ids.substring(0, ids.length - 1)
                            console.log(ids)
                            if (ids == "") {
                                layer.close(index)
                                swal({
                                    title: "",
                                    text: "\n请至少选择一项！\n",
                                    type: "error",
                                    confirmButtonText: "确定",
                                }, function () {
                                    $("#table").bootstrapTable(
                                            "refresh",
                                    )
                                })
                            } else {
                                $.ajax({
                                    url: "@adminC.routes.DataController.deleteSelectedMutationAlias",
                                    type: "post",
                                    data: ids,
                                    contentType: "text/plain;charset=utf-8",
                                    success: function () {
                                        layer.close(index)
                                        swal({
                                            title: "",
                                            text: "\n删除成功！\n",
                                            type: "success",
                                            confirmButtonText: "确定",
                                        }, function () {
                                            $("#table").bootstrapTable(
                                                    "refresh",
                                            )
                                        })
                                    }
                                });
                            }
                        });
            }

            $(function () {
                $("#Mutation").addClass("active")
                $("#table").bootstrapTable({
                    method: 'post',
                    url: "@adminC.routes.DataController.queryAllMutationAlias()",
                    sidePagination: "server",
                    pageNumber: 1,
                    pageList: [10, 20, 50, 100, 200],
                    pageSize: 20,
                    contentType: "application/x-www-form-urlencoded",
                    onLoadSuccess: function () {
                        $(".bs-checkbox").css({
                            'text-align': 'center',
                            'vertical-align': 'middle'
                        })
                    },
                    columns: [
                        {
                            checkbox: true
                        },
                        {
                            field: "id",
                            title: "ID",
                            sortable: false,
                            searchType: false,
                            valign: "middle"
                        },
                        {
                            field: "type",
                            title: "TYPE",
                            sortable: false,
                            searchType: "text",
                            valign: "middle",
                        },
                        {
                            field: "name",
                            title: "NAME",
                            sortable: false,
                            searchType: "text",
                            valign: "middle",
                        },
                        {
                            field: "alias",
                            title: "ALIAS",
                            sortable: false,
                            searchType: "text",
                            valign: "middle",
                        }
                    ]
                })
            })
    </script>
}
